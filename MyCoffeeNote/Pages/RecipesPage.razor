@page "/"
@using MyCoffeeNote.Domain.Entities

@code {
    private string GetStringPropertyLambdaExpression(Recipe pInfo, string name)
    {
        return pInfo.Columns.ContainsKey(name) ? pInfo.Columns[name] : "";
    }

}

<PageTitle>Ваши рецепты</PageTitle>

<MudDataGrid Items="@AllRecipes" T="Recipe" @ref="MudDataGrip"
             Dense="true" Striped="true" Bordered="true" ReadOnly="false"
             DragDropColumnReordering="true"
             EditMode="DataGridEditMode.Cell"
             EditTrigger="DataGridEditTrigger.OnRowClick"
             CommittedItemChanges="@CommittedItemChanges"
             SortMode="SortMode.Single">
    <Columns>
        <PropertyColumn Property="x => x.Description"></PropertyColumn>
        <PropertyColumn Property="x => x.CreationDate.ToLongTimeString()" IsEditable="false"></PropertyColumn> 
        @foreach (string column in AllUniqColumns)
        {
            <PropertyColumn T="Recipe" TProperty="string" Title="@column" Property="@((q) => GetStringPropertyLambdaExpression(q, column))"></PropertyColumn>


          @*   <TemplateColumn Title="@column">
                <CellTemplate>
                    <MudTextField T="Recipe" Variant="Variant.Text" Value="" bind-Value="@Method"></MudTextField>
                </CellTemplate>
            </TemplateColumn> *@
        }

        <TemplateColumn IsEditable="false">
            <CellTemplate>
                <MudButton OnClick="@(() => DeleteLine(context))" Variant="Variant.Outlined"
                           EndIcon="@Icons.Material.Filled.RemoveCircleOutline">
                    Удалить запись
                </MudButton>
            </CellTemplate>
        </TemplateColumn>
    </Columns>
    <ToolBarContent>
        <MudSpacer />
        <MudItem Style="margin-right: 1%;">
            <MudButton OnClick="@AddNewLine" Variant="Variant.Outlined"
                       EndIcon="@Icons.Material.Outlined.AddCircleOutline">
                Добавить новый рецепт
            </MudButton>
        </MudItem>
    </ToolBarContent>
    
</MudDataGrid>
